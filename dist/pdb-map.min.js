// pdb-map@v1.0.1, ISC licensed. https://github.com/cheminfo/pdb-map
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof self&&(r=self),r.pdbMap=t()}}(function(){return function t(r,o,n){function e(s,a){if(!o[s]){if(!r[s]){var f="function"==typeof require&&require;if(!a&&f)return f(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=o[s]={exports:{}};r[s][0].call(h.exports,function(t){var o=r[s][1][t];return e(o?o:t)},h,h.exports,t,r,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)e(n[s]);return e}({1:[function(t,r,o){var n=t("./parser"),e=t("./fingerprint");r.exports={parse:n,fingerprint:e}},{"./fingerprint":60,"./parser":62}],2:[function(t,r,o){},{}],3:[function(t,r,o){(function(t){function r(t,r){for(var o=0,n=t.length-1;n>=0;n--){var e=t[n];"."===e?t.splice(n,1):".."===e?(t.splice(n,1),o++):o&&(t.splice(n,1),o--)}if(r)for(;o--;o)t.unshift("..");return t}function n(t,r){if(t.filter)return t.filter(r);for(var o=[],n=0;n<t.length;n++)r(t[n],n,t)&&o.push(t[n]);return o}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return e.exec(t).slice(1)};o.resolve=function(){for(var o="",e=!1,i=arguments.length-1;i>=-1&&!e;i--){var s=i>=0?arguments[i]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(o=s+"/"+o,e="/"===s.charAt(0))}return o=r(n(o.split("/"),function(t){return!!t}),!e).join("/"),(e?"/":"")+o||"."},o.normalize=function(t){var e=o.isAbsolute(t),i="/"===s(t,-1);return t=r(n(t.split("/"),function(t){return!!t}),!e).join("/"),t||e||(t="."),t&&i&&(t+="/"),(e?"/":"")+t},o.isAbsolute=function(t){return"/"===t.charAt(0)},o.join=function(){var t=Array.prototype.slice.call(arguments,0);return o.normalize(n(t,function(t,r){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},o.relative=function(t,r){function n(t){for(var r=0;r<t.length&&""===t[r];r++);for(var o=t.length-1;o>=0&&""===t[o];o--);return r>o?[]:t.slice(r,o-r+1)}t=o.resolve(t).substr(1),r=o.resolve(r).substr(1);for(var e=n(t.split("/")),i=n(r.split("/")),s=Math.min(e.length,i.length),a=s,f=0;s>f;f++)if(e[f]!==i[f]){a=f;break}for(var u=[],f=a;f<e.length;f++)u.push("..");return u=u.concat(i.slice(a)),u.join("/")},o.sep="/",o.delimiter=":",o.dirname=function(t){var r=i(t),o=r[0],n=r[1];return o||n?(n&&(n=n.substr(0,n.length-1)),o+n):"."},o.basename=function(t,r){var o=i(t)[2];return r&&o.substr(-1*r.length)===r&&(o=o.substr(0,o.length-r.length)),o},o.extname=function(t){return i(t)[3]};var s="b"==="ab".substr(-1)?function(t,r,o){return t.substr(r,o)}:function(t,r,o){return 0>r&&(r=t.length+r),t.substr(r,o)}}).call(this,t("_process"))},{_process:4}],4:[function(t,r,o){function n(){if(!a){a=!0;for(var t,r=s.length;r;){t=s,s=[];for(var o=-1;++o<r;)t[o]();r=s.length}a=!1}}function e(){}var i=r.exports={},s=[],a=!1;i.nextTick=function(t){s.push(t),a||setTimeout(n,0)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=e,i.addListener=e,i.once=e,i.off=e,i.removeListener=e,i.removeAllListeners=e,i.emit=e,i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],5:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o])*(t[o]+r[o])/(t[o]*r[o]);return 2*e}},{}],6:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0,s=0;o>s;s++)i=Math.abs(t[s]-r[s]),e+=i,i>n&&(n=i);return(n+e)/2}},{}],7:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.sqrt(t[e]*r[e]);return-Math.log(n)}},{}],8:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.abs(t[e]-r[e])/(t[e]+r[e]);return n}},{}],9:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)e=Math.abs(t[i]-r[i]),e>n&&(n=e);return n}},{}],10:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=Math.sqrt((t[o]-r[o])*(t[o]-r[o])/((t[o]+r[o])*(t[o]+r[o])));return 2*e}},{}],11:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0,s=0;o>s;s++)n+=t[s]*r[s],e+=t[s]*t[s],i+=r[s]*r[s];return n/(Math.sqrt(e)*Math.sqrt(i))}},{}],12:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=Math.min(t[i],r[i]),e+=t[i]+r[i];return 1-2*n/e}},{}],13:[function(t,r,o){var n=t("./czekanowski");r.exports=function(t,r){return 1-n(t,r)}},{"./czekanowski":12}],14:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0,s=0;o>s;s++)n+=t[s]*t[s],e+=r[s]*r[s],i+=(t[s]-r[s])*(t[s]-r[s]);return i/(n+e)}},{}],15:[function(t,r,o){var n=t("./dice");r.exports=function(t,r){return 1-n(t,r)}},{"./dice":14}],16:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o])/((t[o]+r[o])*(t[o]+r[o]));return 2*e}},{}],17:[function(t,r,o){var n=t("./squared-euclidean");r.exports=function(t,r){return Math.sqrt(n(t,r))}},{"./squared-euclidean":47}],18:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.sqrt(t[e]*r[e]);return n}},{}],19:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.abs(t[e]-r[e]);return n/o}},{}],20:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=t[e]*r[e]/(t[e]+r[e]);return 2*n}},{}],21:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.sqrt(t[e]*r[e]);return 2*Math.sqrt(1-n)}},{}],22:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=t[e]*r[e];return n}},{}],23:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.min(t[e],r[e]);return 1-n}},{}],24:[function(t,r,o){var n=t("./intersection");r.exports=function(t,r){return 1-n(t,r)}},{"./intersection":23}],25:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0,s=0,a=0;o>a;a++)n+=t[a]*r[a],e+=t[a]*t[a],i+=r[a]*r[a],s+=(t[a]-r[a])*(t[a]-r[a]);return s/(e+i-n)}},{}],26:[function(t,r,o){var n=t("./jaccard");r.exports=function(t,r){return 1-n(t,r)}},{"./jaccard":25}],27:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=(t[e]-r[e])*Math.log(t[e]/r[e]);return n}},{}],28:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=(t[e]*Math.log(t[e])+r[e]*Math.log(r[e]))/2-(t[e]+r[e])/2*Math.log((t[e]+r[e])/2);return n}},{}],29:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=t[i]*Math.log(2*t[i]/(t[i]+r[i])),e+=r[i]*Math.log(2*r[i]/(t[i]+r[i]));return(n+e)/2}},{}],30:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=t[e]*Math.log(2*t[e]/(t[e]+r[e]));return n}},{}],31:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=Math.abs(t[i]-r[i]),e+=Math.min(t[i],r[i]);return n/e}},{}],32:[function(t,r,o){var n=t("./kulczynski");r.exports=function(t,r){return 1/n(t,r)}},{"./kulczynski":31}],33:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=t[e]*Math.log(t[e]/r[e]);return n}},{}],34:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0,s=0;o>s;s++)n+=t[s]*r[s],e+=t[s]*t[s],i+=r[s]*r[s];return n/(e+i-n)}},{}],35:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.pow(t[e]*t[e]-r[e]*r[e],2)/(2*Math.pow(t[e]*r[e],1.5));return n}},{}],36:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.log(Math.abs(t[e]-r[e])+1);return n}},{}],37:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=Math.abs(t[o]-r[o]);return e}},{}],38:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=Math.sqrt(t[e]*r[e]);return Math.sqrt(2-2*n)}},{}],39:[function(t,r,o){r.exports=function(t,r,o){for(var n=0,e=t.length,i=0;e>n;n++)i+=Math.pow(Math.abs(t[n]-r[n]),o);return Math.pow(i,1/o)}},{}],40:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=Math.min(t[i],r[i]),e+=t[i]+r[i];return 1-n/e}},{}],41:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o])/t[o];return e}},{}],42:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o])/r[o];return e}},{}],43:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o])/(t[o]+r[o]);return 2*e}},{}],44:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=Math.min(t[i],r[i]),e+=Math.max(t[i],r[i]);return n/e}},{}],45:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=Math.abs(t[i]-r[i]),e+=Math.max(t[i],r[i]);return n/e}},{}],46:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0;o>i;i++)n+=Math.abs(t[i]-r[i]),e+=t[i]+r[i];return n/e}},{}],47:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o]);return e}},{}],48:[function(t,r,o){r.exports=function(t,r){for(var o=0,n=t.length,e=0;n>o;o++)e+=(t[o]-r[o])*(t[o]-r[o])/(t[o]+r[o]);return e}},{}],49:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=(Math.sqrt(t[e])-Math.sqrt(r[e]))*(Math.sqrt(t[e])-Math.sqrt(r[e]));return n}},{}],50:[function(t,r,o){var n=t("./squaredChord");r.exports=function(t,r){return 1-n(t,r)}},{"./squaredChord":49}],51:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=(t[e]+r[e])/2*Math.log((t[e]+r[e])/(2*Math.sqrt(t[e]*r[e])));return n}},{}],52:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0,i=0,s=0;o>s;s++)n+=t[s],e+=r[s],i+=Math.min(t[s],r[s]);return(n+e-2*i)/(n+e-i)}},{}],53:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=t[e]*Math.log(2*t[e]/(t[e]+r[e]))+r[e]*Math.log(2*r[e]/(t[e]+r[e]));return n}},{}],54:[function(t,r,o){r.exports=function(t,r){for(var o=t.length,n=0,e=0;o>e;e++)n+=1-Math.min(t[e],r[e])/Math.max(t[e],r[e]);return n}},{}],55:[function(t,r,o){o.euclidean=t("./dist/euclidean"),o.squaredEuclidean=t("./dist/squared-euclidean"),o.manhattan=t("./dist/manhattan"),o.minkowski=t("./dist/minkowski"),o.chebyshev=t("./dist/chebyshev"),o.sorensen=t("./dist/sorensen"),o.gower=t("./dist/gower"),o.soergel=t("./dist/soergel"),o.kulczynski=t("./dist/kulczynski"),o.kulczynskiS=t("./dist/kulczynskiS"),o.canberra=t("./dist/canberra"),o.lorentzian=t("./dist/lorentzian"),o.intersection=t("./dist/intersection"),o.intersectionS=t("./dist/intersectionS"),o.waveHedges=t("./dist/waveHedges"),o.czekanowski=t("./dist/czekanowski"),o.czekanowskiS=t("./dist/czekanowskiS"),o.motyka=t("./dist/motyka"),o.kulczynskiS=t("./dist/kulczynskiS"),o.ruzicka=t("./dist/ruzicka"),o.tanimoto=t("./dist/tanimoto"),o.innerProduct=t("./dist/innerProduct"),o.harmonicMean=t("./dist/harmonicMean"),o.cosine=t("./dist/cosine"),o.kumarHassebrook=t("./dist/kumarHassebrook"),o.jaccard=t("./dist/jaccard"),o.jaccardS=t("./dist/jaccardS"),o.dice=t("./dist/dice"),o.diceS=t("./dist/diceS"),o.fidelity=t("./dist/fidelity"),o.bhattacharyya=t("./dist/bhattacharyya"),o.hellinger=t("./dist/hellinger"),o.matusita=t("./dist/matusita"),o.squaredChord=t("./dist/squaredChord"),o.squaredChordS=t("./dist/squaredChordS"),o.pearson=t("./dist/pearson"),o.neyman=t("./dist/neyman"),o.squared=t("./dist/squared"),o.probabilisticSymmetric=t("./dist/probabilisticSymmetric"),o.divergence=t("./dist/divergence"),o.clark=t("./dist/clark"),o.additiveSymmetric=t("./dist/additiveSymmetric"),o.kullbackLeibler=t("./dist/kullbackLeibler"),o.jeffreys=t("./dist/jeffreys"),o.kdivergence=t("./dist/kdivergence"),o.topsoe=t("./dist/topsoe"),o.jensenShannon=t("./dist/jensenShannon"),o.jensenDifference=t("./dist/jensenDifference"),o.taneja=t("./dist/taneja"),o.kumarJohnson=t("./dist/kumarJohnson"),o.avg=t("./dist/avg")},{"./dist/additiveSymmetric":5,"./dist/avg":6,"./dist/bhattacharyya":7,"./dist/canberra":8,"./dist/chebyshev":9,"./dist/clark":10,"./dist/cosine":11,"./dist/czekanowski":12,"./dist/czekanowskiS":13,"./dist/dice":14,"./dist/diceS":15,"./dist/divergence":16,"./dist/euclidean":17,"./dist/fidelity":18,"./dist/gower":19,"./dist/harmonicMean":20,"./dist/hellinger":21,"./dist/innerProduct":22,"./dist/intersection":23,"./dist/intersectionS":24,"./dist/jaccard":25,"./dist/jaccardS":26,"./dist/jeffreys":27,"./dist/jensenDifference":28,"./dist/jensenShannon":29,"./dist/kdivergence":30,"./dist/kulczynski":31,"./dist/kulczynskiS":32,"./dist/kullbackLeibler":33,"./dist/kumarHassebrook":34,"./dist/kumarJohnson":35,"./dist/lorentzian":36,"./dist/manhattan":37,"./dist/matusita":38,"./dist/minkowski":39,"./dist/motyka":40,"./dist/neyman":41,"./dist/pearson":42,"./dist/probabilisticSymmetric":43,"./dist/ruzicka":44,"./dist/soergel":45,"./dist/sorensen":46,"./dist/squared":48,"./dist/squared-euclidean":47,"./dist/squaredChord":49,"./dist/squaredChordS":50,"./dist/taneja":51,"./dist/tanimoto":52,"./dist/topsoe":53,"./dist/waveHedges":54}],56:[function(t,r,o){"use strict";function n(t){if(t=M.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var r,o,n=t.columns,f=M.zeros(n,n),h=new Array(n),c=new Array(n),l=t;if(t.isSymmetric()){for(r=0;n>r;r++)for(o=0;n>o;o++)f[r][o]=l[r][o];e(n,c,h,f),i(n,c,h,f)}else{var p=M.zeros(n,n),m=new Array(n);for(o=0;n>o;o++)for(r=0;n>r;r++)p[r][o]=l[r][o];s(n,p,m,f),a(n,c,h,f,p)}return new u(n,c,h,f)}function e(t,r,o,n){var e,i,s,a,f,u,h,c;for(f=0;t>f;f++)o[f]=n[t-1][f];for(a=t-1;a>0;a--){for(c=0,s=0,u=0;a>u;u++)c+=Math.abs(o[u]);if(0===c)for(r[a]=o[a-1],f=0;a>f;f++)o[f]=n[a-1][f],n[a][f]=0,n[f][a]=0;else{for(u=0;a>u;u++)o[u]/=c,s+=o[u]*o[u];for(e=o[a-1],i=Math.sqrt(s),e>0&&(i=-i),r[a]=c*i,s-=e*i,o[a-1]=e-i,f=0;a>f;f++)r[f]=0;for(f=0;a>f;f++){for(e=o[f],n[f][a]=e,i=r[f]+n[f][f]*e,u=f+1;a-1>=u;u++)i+=n[u][f]*o[u],r[u]+=n[u][f]*e;r[f]=i}for(e=0,f=0;a>f;f++)r[f]/=s,e+=r[f]*o[f];for(h=e/(s+s),f=0;a>f;f++)r[f]-=h*o[f];for(f=0;a>f;f++){for(e=o[f],i=r[f],u=f;a-1>=u;u++)n[u][f]-=e*r[u]+i*o[u];o[f]=n[a-1][f],n[a][f]=0}}o[a]=s}for(a=0;t-1>a;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,s=o[a+1],0!==s){for(u=0;a>=u;u++)o[u]=n[u][a+1]/s;for(f=0;a>=f;f++){for(i=0,u=0;a>=u;u++)i+=n[u][a+1]*n[u][f];for(u=0;a>=u;u++)n[u][f]-=i*o[u]}}for(u=0;a>=u;u++)n[u][a+1]=0}for(f=0;t>f;f++)o[f]=n[t-1][f],n[t-1][f]=0;n[t-1][t-1]=1,r[0]=0}function i(t,r,o,n){var e,i,s,a,f,u,h,c,l,p,m,d,v,w,y,b,M;for(s=1;t>s;s++)r[s-1]=r[s];r[t-1]=0;var x=0,k=0,C=Math.pow(2,-52);for(u=0;t>u;u++){for(k=Math.max(k,Math.abs(o[u])+Math.abs(r[u])),h=u;t>h&&!(Math.abs(r[h])<=C*k);)h++;if(h>u){M=0;do{for(M+=1,e=o[u],c=(o[u+1]-e)/(2*r[u]),l=g(c,1),0>c&&(l=-l),o[u]=r[u]/(c+l),o[u+1]=r[u]*(c+l),p=o[u+1],i=e-o[u],s=u+2;t>s;s++)o[s]-=i;for(x+=i,c=o[h],m=1,d=m,v=m,w=r[u+1],y=0,b=0,s=h-1;s>=u;s--)for(v=d,d=m,b=y,e=m*r[s],i=m*c,l=g(c,r[s]),r[s+1]=y*l,y=r[s]/l,m=c/l,c=m*o[s]-y*e,o[s+1]=i+y*(m*e+y*o[s]),f=0;t>f;f++)i=n[f][s+1],n[f][s+1]=y*n[f][s]+m*i,n[f][s]=m*n[f][s]-y*i;c=-y*b*v*w*r[u]/p,r[u]=y*c,o[u]=m*c}while(Math.abs(r[u])>C*k)}o[u]=o[u]+x,r[u]=0}for(s=0;t-1>s;s++){for(f=s,c=o[s],a=s+1;t>a;a++)o[a]<c&&(f=a,c=o[a]);if(f!==s)for(o[f]=o[s],o[s]=c,a=0;t>a;a++)c=n[a][s],n[a][s]=n[a][f],n[a][f]=c}}function s(t,r,o,n){var e,i,s,a,f,u,h,c=0,l=t-1;for(u=c+1;l-1>=u;u++){for(h=0,a=u;l>=a;a++)h+=Math.abs(r[a][u-1]);if(0!==h){for(s=0,a=l;a>=u;a--)o[a]=r[a][u-1]/h,s+=o[a]*o[a];for(i=Math.sqrt(s),o[u]>0&&(i=-i),s-=o[u]*i,o[u]=o[u]-i,f=u;t>f;f++){for(e=0,a=l;a>=u;a--)e+=o[a]*r[a][f];for(e/=s,a=u;l>=a;a++)r[a][f]-=e*o[a]}for(a=0;l>=a;a++){for(e=0,f=l;f>=u;f--)e+=o[f]*r[a][f];for(e/=s,f=u;l>=f;f++)r[a][f]-=e*o[f]}o[u]=h*o[u],r[u][u-1]=h*i}}for(a=0;t>a;a++)for(f=0;t>f;f++)n[a][f]=a===f?1:0;for(u=l-1;u>=c+1;u--)if(0!==r[u][u-1]){for(a=u+1;l>=a;a++)o[a]=r[a][u-1];for(f=u;l>=f;f++){for(i=0,a=u;l>=a;a++)i+=o[a]*n[a][f];for(i=i/o[u]/r[u][u-1],a=u;l>=a;a++)n[a][f]+=i*o[a]}}}function a(t,r,o,n,e){var i,s,a,u,h,c,l,p,m,d,v,w,g,y,b,M=t-1,x=0,k=t-1,C=Math.pow(2,-52),A=0,R=0,j=0,S=0,z=0,q=0,D=0,E=0;for(i=0;t>i;i++)for((x>i||i>k)&&(o[i]=e[i][i],r[i]=0),s=Math.max(i-1,0);t>s;s++)R+=Math.abs(e[i][s]);for(;M>=x;){for(u=M;u>x&&(q=Math.abs(e[u-1][u-1])+Math.abs(e[u][u]),0===q&&(q=R),!(Math.abs(e[u][u-1])<C*q));)u--;if(u===M)e[M][M]=e[M][M]+A,o[M]=e[M][M],r[M]=0,M--,E=0;else if(u===M-1){if(l=e[M][M-1]*e[M-1][M],j=(e[M-1][M-1]-e[M][M])/2,S=j*j+l,D=Math.sqrt(Math.abs(S)),e[M][M]=e[M][M]+A,e[M-1][M-1]=e[M-1][M-1]+A,p=e[M][M],S>=0){for(D=j>=0?j+D:j-D,o[M-1]=p+D,o[M]=o[M-1],0!==D&&(o[M]=p-l/D),r[M-1]=0,r[M]=0,p=e[M][M-1],q=Math.abs(p)+Math.abs(D),j=p/q,S=D/q,z=Math.sqrt(j*j+S*S),j/=z,S/=z,s=M-1;t>s;s++)D=e[M-1][s],e[M-1][s]=S*D+j*e[M][s],e[M][s]=S*e[M][s]-j*D;for(i=0;M>=i;i++)D=e[i][M-1],e[i][M-1]=S*D+j*e[i][M],e[i][M]=S*e[i][M]-j*D;for(i=x;k>=i;i++)D=n[i][M-1],n[i][M-1]=S*D+j*n[i][M],n[i][M]=S*n[i][M]-j*D}else o[M-1]=p+j,o[M]=p+j,r[M-1]=D,r[M]=-D;M-=2,E=0}else{if(p=e[M][M],m=0,l=0,M>u&&(m=e[M-1][M-1],l=e[M][M-1]*e[M-1][M]),10===E){for(A+=p,i=x;M>=i;i++)e[i][i]-=p;q=Math.abs(e[M][M-1])+Math.abs(e[M-1][M-2]),p=m=.75*q,l=-.4375*q*q}if(30===E&&(q=(m-p)/2,q=q*q+l,q>0)){for(q=Math.sqrt(q),p>m&&(q=-q),q=p-l/((m-p)/2+q),i=x;M>=i;i++)e[i][i]-=q;A+=q,p=m=l=.964}for(E+=1,h=M-2;h>=u&&(D=e[h][h],z=p-D,q=m-D,j=(z*q-l)/e[h+1][h]+e[h][h+1],S=e[h+1][h+1]-D-z-q,z=e[h+2][h+1],q=Math.abs(j)+Math.abs(S)+Math.abs(z),j/=q,S/=q,z/=q,h!==u)&&!(Math.abs(e[h][h-1])*(Math.abs(S)+Math.abs(z))<C*Math.abs(j)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1])));)h--;for(i=h+2;M>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;M-1>=a&&(y=a!==M-1,a!==h&&(j=e[a][a-1],S=e[a+1][a-1],z=y?e[a+2][a-1]:0,p=Math.abs(j)+Math.abs(S)+Math.abs(z),0!==p&&(j/=p,S/=p,z/=p)),0!==p);a++)if(q=Math.sqrt(j*j+S*S+z*z),0>j&&(q=-q),0!==q){for(a!==h?e[a][a-1]=-q*p:u!==h&&(e[a][a-1]=-e[a][a-1]),j+=q,p=j/q,m=S/q,D=z/q,S/=j,z/=j,s=a;t>s;s++)j=e[a][s]+S*e[a+1][s],y&&(j+=z*e[a+2][s],e[a+2][s]=e[a+2][s]-j*D),e[a][s]=e[a][s]-j*p,e[a+1][s]=e[a+1][s]-j*m;for(i=0;i<=Math.min(M,a+3);i++)j=p*e[i][a]+m*e[i][a+1],y&&(j+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-j*z),e[i][a]=e[i][a]-j,e[i][a+1]=e[i][a+1]-j*S;for(i=x;k>=i;i++)j=p*n[i][a]+m*n[i][a+1],y&&(j+=D*n[i][a+2],n[i][a+2]=n[i][a+2]-j*z),n[i][a]=n[i][a]-j,n[i][a+1]=n[i][a+1]-j*S}}}if(0!==R){for(M=t-1;M>=0;M--)if(j=o[M],S=r[M],0===S)for(u=M,e[M][M]=1,i=M-1;i>=0;i--){for(l=e[i][i]-j,z=0,s=u;M>=s;s++)z+=e[i][s]*e[s][M];if(r[i]<0)D=l,q=z;else if(u=i,0===r[i]?e[i][M]=0!==l?-z/l:-z/(C*R):(p=e[i][i+1],m=e[i+1][i],S=(o[i]-j)*(o[i]-j)+r[i]*r[i],c=(p*q-D*z)/S,e[i][M]=c,e[i+1][M]=Math.abs(p)>Math.abs(D)?(-z-l*c)/p:(-q-m*c)/D),c=Math.abs(e[i][M]),C*c*c>1)for(s=i;M>=s;s++)e[s][M]=e[s][M]/c}else if(0>S)for(u=M-1,Math.abs(e[M][M-1])>Math.abs(e[M-1][M])?(e[M-1][M-1]=S/e[M][M-1],e[M-1][M]=-(e[M][M]-j)/e[M][M-1]):(b=f(0,-e[M-1][M],e[M-1][M-1]-j,S),e[M-1][M-1]=b[0],e[M-1][M]=b[1]),e[M][M-1]=0,e[M][M]=1,i=M-2;i>=0;i--){for(d=0,v=0,s=u;M>=s;s++)d+=e[i][s]*e[s][M-1],v+=e[i][s]*e[s][M];if(l=e[i][i]-j,r[i]<0)D=l,z=d,q=v;else if(u=i,0===r[i]?(b=f(-d,-v,l,S),e[i][M-1]=b[0],e[i][M]=b[1]):(p=e[i][i+1],m=e[i+1][i],w=(o[i]-j)*(o[i]-j)+r[i]*r[i]-S*S,g=2*(o[i]-j)*S,0===w&&0===g&&(w=C*R*(Math.abs(l)+Math.abs(S)+Math.abs(p)+Math.abs(m)+Math.abs(D))),b=f(p*z-D*d+S*v,p*q-D*v-S*d,w,g),e[i][M-1]=b[0],e[i][M]=b[1],Math.abs(p)>Math.abs(D)+Math.abs(S)?(e[i+1][M-1]=(-d-l*e[i][M-1]+S*e[i][M])/p,e[i+1][M]=(-v-l*e[i][M]-S*e[i][M-1])/p):(b=f(-z-m*e[i][M-1],-q-m*e[i][M],D,S),e[i+1][M-1]=b[0],e[i+1][M]=b[1])),c=Math.max(Math.abs(e[i][M-1]),Math.abs(e[i][M])),C*c*c>1)for(s=i;M>=s;s++)e[s][M-1]=e[s][M-1]/c,e[s][M]=e[s][M]/c}for(i=0;t>i;i++)if(x>i||i>k)for(s=i;t>s;s++)n[i][s]=e[i][s];for(s=t-1;s>=x;s--)for(i=x;k>=i;i++){for(D=0,a=x;a<=Math.min(s,k);a++)D+=n[i][a]*e[a][s];n[i][s]=D}}}function f(t,r,o,n){var e,i;return Math.abs(o)>Math.abs(n)?(e=n/o,i=o+e*n,[(t+e*r)/i,(r-e*t)/i]):(e=o/n,i=n+e*o,[(e*t+r)/i,(e*r-t)/i])}function u(t,r,o,n){this.n=t,this.e=r,this.d=o,this.V=n}function h(t){t=M.checkMatrix(t);var r,o,n,e,i,s,a,f,u,h,l=t.clone(),p=l.rows,m=l.columns,d=new Array(p),v=1;for(r=0;p>r;r++)d[r]=r;for(u=new Array(p),o=0;m>o;o++){for(r=0;p>r;r++)u[r]=l[r][o];for(r=0;p>r;r++){for(f=l[r],h=Math.min(r,o),i=0,n=0;h>n;n++)i+=f[n]*u[n];f[o]=u[r]-=i}for(e=o,r=o+1;p>r;r++)Math.abs(u[r])>Math.abs(u[e])&&(e=r);if(e!==o){for(n=0;m>n;n++)s=l[e][n],l[e][n]=l[o][n],l[o][n]=s;a=d[e],d[e]=d[o],d[o]=a,v=-v}if(p>o&&0!==l[o][o])for(r=o+1;p>r;r++)l[r][o]/=l[o][o]}return new c(l,d,v)}function c(t,r,o){this.LU=t,this.pivotVector=r,this.pivotSign=o}function l(t){t=M.checkMatrix(t);var r,o,n,e,i=t.clone(),s=t.rows,a=t.columns,f=new Array(a);for(n=0;a>n;n++){var u=0;for(r=n;s>r;r++)u=g(u,i[r][n]);if(0!==u){for(i[n][n]<0&&(u=-u),r=n;s>r;r++)i[r][n]/=u;for(i[n][n]+=1,o=n+1;a>o;o++){for(e=0,r=n;s>r;r++)e+=i[r][n]*i[r][o];for(e=-e/i[n][n],r=n;s>r;r++)i[r][o]+=e*i[r][n]}}f[n]=-u}return new p(i,f)}function p(t,r){this.QR=t,this.Rdiag=r}function m(t,r){t=M.checkMatrix(t),r=r||{};var o=t.clone(),n=t.rows,e=t.columns,i=Math.min(n,e),s=!0,a=!0;r.computeLeftSingularVectors===!1&&(s=!1),r.computeRightSingularVectors===!1&&(a=!1);var f=r.autoTranspose===!0,u=!1;if(e>n)if(f){o=o.transpose(),n=o.rows,e=o.columns,u=!0;var h=s;s=a,a=h}else console.warn("WARNING: Computing SVD on a matrix with more columns than rows.");var c,l,p,m,v,w,y,b,x,k,C,A,R,j,S,z,q,D,E,V,I,L=new Array(Math.min(n+1,e)),O=M.zeros(n,i),T=M.zeros(e,e),P=new Array(e),G=new Array(n),U=Math.min(n-1,e),H=Math.max(0,Math.min(e-2,n));for(p=0,k=Math.max(U,H);k>p;p++){if(U>p){for(L[p]=0,c=p;n>c;c++)L[p]=g(L[p],o[c][p]);if(0!==L[p]){for(o[p][p]<0&&(L[p]=-L[p]),c=p;n>c;c++)o[c][p]/=L[p];o[p][p]+=1}L[p]=-L[p]}for(l=p+1;e>l;l++){if(U>p&&0!==L[p]){for(v=0,c=p;n>c;c++)v+=o[c][p]*o[c][l];for(v=-v/o[p][p],c=p;n>c;c++)o[c][l]+=v*o[c][p]}P[l]=o[p][l]}if(s&&U>p)for(c=p;n>c;c++)O[c][p]=o[c][p];if(H>p){for(P[p]=0,c=p+1;e>c;c++)P[p]=g(P[p],P[c]);if(0!==P[p]){for(P[p+1]<0&&(P[p]=-P[p]),c=p+1;e>c;c++)P[c]/=P[p];P[p+1]+=1}if(P[p]=-P[p],n>p+1&&0!==P[p]){for(c=p+1;n>c;c++)G[c]=0;for(l=p+1;e>l;l++)for(c=p+1;n>c;c++)G[c]+=P[l]*o[c][l];for(l=p+1;e>l;l++)for(v=-P[l]/P[p+1],c=p+1;n>c;c++)o[c][l]+=v*G[c]}if(a)for(c=p+1;e>c;c++)T[c][p]=P[c]}}if(m=Math.min(e,n+1),e>U&&(L[U]=o[U][U]),m>n&&(L[m-1]=0),m>H+1&&(P[H]=o[H][m-1]),P[m-1]=0,s){for(l=U;i>l;l++){for(c=0;n>c;c++)O[c][l]=0;O[l][l]=1}for(p=U-1;p>=0;p--)if(0!==L[p]){for(l=p+1;i>l;l++){for(v=0,c=p;n>c;c++)v+=O[c][p]*O[c][l];for(v=-v/O[p][p],c=p;n>c;c++)O[c][l]+=v*O[c][p]}for(c=p;n>c;c++)O[c][p]=-O[c][p];for(O[p][p]=1+O[p][p],c=0;p-1>c;c++)O[c][p]=0}else{for(c=0;n>c;c++)O[c][p]=0;O[p][p]=1}}if(a)for(p=e-1;p>=0;p--){if(H>p&&0!==P[p])for(l=p+1;e>l;l++){for(v=0,c=p+1;e>c;c++)v+=T[c][p]*T[c][l];for(v=-v/T[p+1][p],c=p+1;e>c;c++)T[c][l]+=v*T[c][p]}for(c=0;e>c;c++)T[c][p]=0;T[p][p]=1}for(var B=m-1,N=0,Y=Math.pow(2,-52);m>0;){for(p=m-2;p>=-1&&-1!==p;p--)if(Math.abs(P[p])<=Y*(Math.abs(L[p])+Math.abs(L[p+1]))){P[p]=0;break}if(p===m-2)C=4;else{for(w=m-1;w>=p&&w!==p;w--)if(v=(w!==m?Math.abs(P[w]):0)+(w!==p+1?Math.abs(P[w-1]):0),Math.abs(L[w])<=Y*v){L[w]=0;break}w===p?C=3:w===m-1?C=1:(C=2,p=w)}switch(p++,C){case 1:for(y=P[m-2],P[m-2]=0,l=m-2;l>=p;l--)if(v=g(L[l],y),b=L[l]/v,x=y/v,L[l]=v,l!==p&&(y=-x*P[l-1],P[l-1]=b*P[l-1]),a)for(c=0;e>c;c++)v=b*T[c][l]+x*T[c][m-1],T[c][m-1]=-x*T[c][l]+b*T[c][m-1],T[c][l]=v;break;case 2:for(y=P[p-1],P[p-1]=0,l=p;m>l;l++)if(v=g(L[l],y),b=L[l]/v,x=y/v,L[l]=v,y=-x*P[l],P[l]=b*P[l],s)for(c=0;n>c;c++)v=b*O[c][l]+x*O[c][p-1],O[c][p-1]=-x*O[c][l]+b*O[c][p-1],O[c][l]=v;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(L[m-1]),Math.abs(L[m-2])),Math.abs(P[m-2])),Math.abs(L[p])),Math.abs(P[p])),R=L[m-1]/A,j=L[m-2]/A,S=P[m-2]/A,z=L[p]/A,q=P[p]/A,D=((j+R)*(j-R)+S*S)/2,E=R*S*R*S,V=0,(0!==D||0!==E)&&(V=Math.sqrt(D*D+E),0>D&&(V=-V),V=E/(D+V)),y=(z+R)*(z-R)+V,I=z*q,l=p;m-1>l;l++){if(v=g(y,I),b=y/v,x=I/v,l!==p&&(P[l-1]=v),y=b*L[l]+x*P[l],P[l]=b*P[l]-x*L[l],I=x*L[l+1],L[l+1]=b*L[l+1],a)for(c=0;e>c;c++)v=b*T[c][l]+x*T[c][l+1],T[c][l+1]=-x*T[c][l]+b*T[c][l+1],T[c][l]=v;if(v=g(y,I),b=y/v,x=I/v,L[l]=v,y=b*P[l]+x*L[l+1],L[l+1]=-x*P[l]+b*L[l+1],I=x*P[l+1],P[l+1]=b*P[l+1],s&&n-1>l)for(c=0;n>c;c++)v=b*O[c][l]+x*O[c][l+1],O[c][l+1]=-x*O[c][l]+b*O[c][l+1],O[c][l]=v}P[m-2]=y,N+=1;break;case 4:if(L[p]<=0&&(L[p]=L[p]<0?-L[p]:0,a))for(c=0;B>=c;c++)T[c][p]=-T[c][p];for(;B>p&&!(L[p]>=L[p+1]);){if(v=L[p],L[p]=L[p+1],L[p+1]=v,a&&e-1>p)for(c=0;e>c;c++)v=T[c][p+1],T[c][p+1]=T[c][p],T[c][p]=v;if(s&&n-1>p)for(c=0;n>c;c++)v=O[c][p+1],O[c][p+1]=O[c][p],O[c][p]=v;p++}N=0,m--}}if(u){var _=T;T=O,O=_}return new d(n,e,L,O,T)}function d(t,r,o,n,e){this.m=t,this.n=r,this.s=o,this.U=n,this.V=e}function v(t){if(t=M.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var r,o,n,e=t,i=e.rows,s=new M(i,i),a=!0;for(o=0;i>o;o++){var f=s[o],u=0;for(n=0;o>n;n++){var h=s[n],c=0;for(r=0;n>r;r++)c+=h[r]*f[r];f[n]=c=(e[o][n]-c)/s[n][n],u+=c*c}for(u=e[o][o]-u,a&=u>0,s[o][o]=Math.sqrt(Math.max(u,0)),n=o+1;i>n;n++)s[o][n]=0}if(!a)throw new Error("Matrix is not positive definite");return new w(s)}function w(t){this.L=t}function g(t,r){var o;return Math.abs(t)>Math.abs(r)?(o=r/t,Math.abs(t)*Math.sqrt(1+o*o)):0!==r?(o=t/r,Math.abs(r)*Math.sqrt(1+o*o)):0}function y(t){return b(t,M.eye(t.rows))}function b(t,r){return t.isSquare()?new h(t).solve(r):new l(t).solve(r)}var M=t("./matrix");u.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,r,o=this.n,n=this.e,e=this.d,i=new M(o,o);for(t=0;o>t;t++){for(r=0;o>r;r++)i[t][r]=0;i[t][t]=e[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}},c.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,o=0;r>o;o++)if(0===t[o][o])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,o=t.columns,n=0;o>n;n++)r*=t[n][n];return r},get lowerTriangularFactor(){for(var t=this.LU,r=t.rows,o=t.columns,n=new M(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=e>i?t[e][i]:e===i?1:0;return n},get upperTriangularFactor(){for(var t=this.LU,r=t.rows,o=t.columns,n=new M(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=i>=e?t[e][i]:0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=M.checkMatrix(t);var r=this.LU,o=r.rows;if(o!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,e,i,s=t.columns,a=t.subMatrixRow(this.pivotVector,0,s-1),f=r.columns;for(i=0;f>i;i++)for(n=i+1;f>n;n++)for(e=0;s>e;e++)a[n][e]-=a[i][e]*r[n][i];for(i=f-1;i>=0;i--){for(e=0;s>e;e++)a[i][e]/=r[i][i];for(n=0;i>n;n++)for(e=0;s>e;e++)a[n][e]-=a[i][e]*r[n][i]}return a}},p.prototype={solve:function(t){t=M.checkMatrix(t);var r=this.QR,o=r.rows;if(t.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,e,i,s,a=t.columns,f=t.clone(),u=r.columns;for(i=0;u>i;i++)for(e=0;a>e;e++){for(s=0,n=i;o>n;n++)s+=r[n][i]*f[n][e];for(s=-s/r[i][i],n=i;o>n;n++)f[n][e]+=s*r[n][i]}for(i=u-1;i>=0;i--){for(e=0;a>e;e++)f[i][e]/=this.Rdiag[i];for(n=0;i>n;n++)for(e=0;a>e;e++)f[n][e]-=f[i][e]*r[n][i]}return f.subMatrix(0,u-1,0,a-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;t>r;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularFactor(){var t,r,o=this.QR,n=o.columns,e=new M(n,n);for(t=0;n>t;t++)for(r=0;n>r;r++)e[t][r]=r>t?o[t][r]:t===r?this.Rdiag[t]:0;return e},get orthogonalFactor(){var t,r,o,n,e=this.QR,i=e.rows,s=e.columns,a=new M(i,s);for(o=s-1;o>=0;o--){for(t=0;i>t;t++)a[t][o]=0;for(a[o][o]=1,r=o;s>r;r++)if(0!==e[o][o]){for(n=0,t=o;i>t;t++)n+=e[t][o]*a[t][r];for(n=-n/e[o][o],t=o;i>t;t++)a[t][r]+=n*e[t][o]}}return a}},d.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,o=0,n=this.s,e=0,i=n.length;i>e;e++)n[e]>r&&o++;return o},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return M.diag(this.s)},solve:function(t){var r,o=t,n=this.threshold,e=this.s.length,i=M.zeros(e,e);for(r=0;e>r;r++)i[r][r]=Math.abs(this.s[r])<=n?0:1/this.s[r];var s,a,f,u=this.V.mmul(i),h=this.V.rows,c=this.U.rows,l=M.zeros(h,c);for(r=0;h>r;r++)for(s=0;c>s;s++){for(f=0,a=0;e>a;a++)f+=u[r][a]*this.U[s][a];l[r][s]=f}return l.mmul(o)},solveForDiagonal:function(t){return this.solve(M.diag(t))},inverse:function(){var t,r,o=this.threshold,n=this.V.rows,e=this.V.columns,i=new M(n,this.s.length);for(t=0;n>t;t++)for(r=0;e>r;r++)Math.abs(this.s[r])>o&&(i[t][r]=this.V[t][r]/this.s[r]);var s,a,f=this.U.rows,u=this.U.columns,h=new M(n,f);for(t=0;n>t;t++)for(r=0;f>r;r++){for(a=0,s=0;u>s;s++)a+=i[t][s]*this.U[r][s];h[t][r]=a}return h}},w.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=M.checkMatrix(t);var r=this.L,o=r.rows;if(t.rows!==o)throw new Error("Matrix dimensions do not match");var n,e,i,s=t.columns,a=t.clone();for(i=0;o>i;i++)for(e=0;s>e;e++){for(n=0;i>n;n++)a[i][e]-=a[n][e]*r[i][n];a[i][e]/=r[i][i]}for(i=o-1;i>=0;i--)for(e=0;s>e;e++){for(n=i+1;o>n;n++)a[i][e]-=a[n][e]*r[n][i];a[i][e]/=r[i][i]}return a}},M.prototype.inverse=function(){return y(this)},M.prototype.solve=function(t){return b(this,t)},r.exports={LuDecomposition:h,LU:h,QrDecomposition:l,QR:l,SingularValueDecomposition:m,SVD:m,EigenvalueDecomposition:n,EVD:n,CholeskyDecomposition:v,CHO:v,inverse:y,solve:b}},{"./matrix":58}],57:[function(t,r,o){"use strict";r.exports=t("./matrix"),r.exports.Decompositions=r.exports.DC=t("./decompositions")},{"./decompositions":56,"./matrix":58}],58:[function(t,r,o){"use strict";function n(t){for(var r=0,o=t.length,n=new Array(o);o>r;r++)n[r]=t[r];return n}function e(t){this.message=t||"Unknown matrix error"}function i(t,r){var o,s,a=0;if(t instanceof Array){if(s=r,o=s?n(t):t,t=o.length,r=o[0].length,"undefined"==typeof r)throw new e("Data must be a 2D array");if(!(t>0&&r>0))throw new e("Invalid dimensions: "+t+"x"+r);for(;t>a;a++){if(o[a].length!==r)throw new e("Inconsistent array dimensions");s&&(o[a]=n(o[a]))}}else{if("number"!=typeof t)throw new e("Invalid arguments");if(!(t>0&&r>0))throw new e("Invalid dimensions: "+t+"x"+r);for(o=new Array(t);t>a;a++)o[a]=new Array(r)}return Object.defineProperty(o,"rows",{writable:!0,value:t}),Object.defineProperty(o,"columns",{writable:!0,value:r}),o.__proto__=i.prototype,o}var s=Array.prototype.splice,a=Array.prototype.concat;e.prototype=Object.create(Error.prototype),e.prototype.name="MatrixError",e.prototype.constructor=e,i.from1DArray=function(t,r,o){var n,s,a=0;if(n=t*r,n!==o.length)throw new e("Data length does not match given dimensions");for(s=new Array(t);t>a;a++)s[a]=o.slice(a*r,(a+1)*r);return new i(s)},i.rowVector=function(t){return new i([t])},i.columnVector=function(t){for(var r=t.length,o=new Array(r),n=0;r>n;n++)o[n]=[t[n]];return new i(o)},i.empty=function(t,r){return new i(t,r)},i.zeros=function(t,r){return i.empty(t,r).fill(0)},i.ones=function(t,r){return i.empty(t,r).fill(1)},i.rand=function(t,r){for(var o=i.empty(t,r),n=0,e=o.rows;e>n;n++)for(var s=0,a=o.columns;a>s;s++)o[n][s]=Math.random();return o},i.eye=function(t){for(var r=i.zeros(t,t),o=r.rows,n=0;o>n;n++)r[n][n]=1;return r},i.diag=function(t){for(var r=t.length,o=i.zeros(r,r),n=0;r>n;n++)o[n][n]=t[n];return o},i.indices=function(t,r){for(var o=new Array(r-t),n=0;n<o.length;n++)o[n]=t++;return o},i.stack=function(t){var r,o,n;if(i.isMatrix(t)){var e=0,s=0;for(r=0;r<arguments.length;r++)e+=arguments[r].rows,arguments[r].columns>s&&(s=arguments[r].columns);var a=i.zeros(e,s),f=0;for(r=0;r<arguments.length;r++){var u=arguments[r];for(o=0;o<u.rows;o++){
for(n=0;n<u.columns;n++)a[f][n]=u[o][n];f++}}return a}if(t instanceof Array){var h=i.empty(arguments.length,t.length);for(r=0;r<arguments.length;r++)h.setRow(r,arguments[r]);return h}},i.expand=function(t,r){for(var o=[],n=0;n<r.length;n++)for(var e=0;e<r[n];e++)o.push(t[n]);return new i(o)},i.checkMatrix=function(t){if(!t)throw new e("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new i(t)),t},i.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(i.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(i.prototype,"size",{get:function(){return this.rows*this.columns}}),i.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new e("Row index out of range.")},i.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new e("Column index out of range.")},i.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new e("Matrices dimensions must be equal.")},i.prototype.apply=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t.call(this,n,e);return this},i.prototype.clone=function(){return new i(this.to2DArray())},i.prototype.to1DArray=function(){return a.apply([],this)},i.prototype.to2DArray=function(){for(var t=this.rows,r=new Array(t),o=0;t>o;o++)r[o]=n(this[o]);return r},i.prototype.isRowVector=function(){return 1===this.rows},i.prototype.isColumnVector=function(){return 1===this.columns},i.prototype.isVector=function(){return 1===this.rows||1===this.columns},i.prototype.isSquare=function(){return this.rows===this.columns},i.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,r=0;t>r;r++)for(var o=0;r>=o;o++)if(this[r][o]!==this[o][r])return!1;return!0}return!1},i.prototype.set=function(t,r,o){return this[t][r]=o,this},i.prototype.get=function(t,r){return this[t][r]},i.prototype.fill=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]=t;return this},i.prototype.neg=function(){return this.mulS(-1)},i.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=i.checkMatrix(t),this.addM(t))},i.prototype.addS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t;return this},i.prototype.addM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[n][e];return this},i.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=i.checkMatrix(t),this.subM(t))},i.prototype.subS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t;return this},i.prototype.subM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[n][e];return this},i.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=i.checkMatrix(t),this.mulM(t))},i.prototype.mulS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t;return this},i.prototype.mulM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[n][e];return this},i.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=i.checkMatrix(t),this.divM(t))},i.prototype.divS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t;return this},i.prototype.divM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[n][e];return this},i.prototype.getRow=function(t){return this.checkRowIndex(t),n(this[t])},i.prototype.setRow=function(t,r){if(this.checkRowIndex(t),i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new e("Invalid row size");return this[t]=n(r),this},i.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new e("A matrix cannot have less than one row");return s.call(this,t,1),this.rows-=1,this},i.prototype.addRow=function(t,r){if("undefined"==typeof r&&(r=t,t=this.rows),0>t||t>this.rows)throw new e("Row index out of range.");if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new e("Invalid row size");return s.call(this,t,0,n(r)),this.rows+=1,this},i.prototype.swapRows=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);var o=this[t];return this[t]=this[r],this[r]=o,this},i.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var r=this.rows,o=new Array(r),n=0;r>n;n++)o[n]=this[n][t];return o},i.prototype.setColumn=function(t,r){this.checkColumnIndex(t),i.isMatrix(r)&&(r=r.to1DArray());var o=this.rows;if(r.length!==o)throw new e("Invalid column size");for(var n=0;o>n;n++)this[n][t]=r[n];return this},i.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new e("A matrix cannot have less than one column");for(var r=0,o=this.rows;o>r;r++)this[r].splice(t,1);return this.columns-=1,this},i.prototype.addColumn=function(t,r){if("undefined"==typeof r&&(r=t,t=this.columns),0>t||t>this.columns)throw new e("Column index out of range.");i.isMatrix(r)&&(r=r.to1DArray());var o=this.rows;if(r.length!==o)throw new e("Invalid column size");for(var n=0;o>n;n++)this[n].splice(t,0,r[n]);return this.columns+=1,this},i.prototype.swapColumns=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);for(var o,n,e=this.rows,i=0;e>i;i++)n=this[i],o=n[t],n[t]=n[r],n[r]=o;return this},i.prototype.checkRowVector=function(t){if(i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("vector size must be the same as the number of columns");return t},i.prototype.checkColumnVector=function(t){if(i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new e("vector size must be the same as the number of rows");return t},i.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[e];return this},i.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[e];return this},i.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[e];return this},i.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[e];return this},i.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[n];return this},i.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[n];return this},i.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[n];return this},i.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[n];return this},i.prototype.mulRow=function(t,r){this.checkRowIndex(t);for(var o=0,n=this.columns;n>o;o++)this[t][o]*=r;return this},i.prototype.mulColumn=function(t,r){this.checkColumnIndex(t);for(var o=0,n=this.rows;n>o;o++)this[o][t]*=r},i.prototype.max=function(){for(var t=-(1/0),r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]>t&&(t=this[n][e]);return t},i.prototype.maxIndex=function(){for(var t=-(1/0),r={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]>t&&(t=this[e][i],r.row=e,r.column=i);return r},i.prototype.min=function(){for(var t=1/0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]<t&&(t=this[n][e]);return t},i.prototype.minIndex=function(){for(var t=1/0,r={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]<t&&(t=this[e][i],r.row=e,r.column=i);return r},i.prototype.maxRow=function(t){this.checkRowIndex(t);for(var r=-(1/0),o=0,n=this.columns;n>o;o++)this[t][o]>r&&(r=this[t][o]);return r},i.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var r=-(1/0),o={row:t},n=0,e=this.columns;e>n;n++)this[t][n]>r&&(r=this[t][n],o.column=n);return o},i.prototype.minRow=function(t){this.checkRowIndex(t);for(var r=1/0,o=0,n=this.columns;n>o;o++)this[t][o]<r&&(r=this[t][o]);return r},i.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var r=1/0,o={row:t,column:0},n=0,e=this.columns;e>n;n++)this[t][n]<r&&(r=this[t][n],o.column=n);return o},i.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var r=-(1/0),o=0,n=this.rows;n>o;o++)this[o][t]>r&&(r=this[o][t]);return r},i.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var r=-(1/0),o={row:0,column:t},n=0,e=this.rows;e>n;n++)this[n][t]>r&&(r=this[n][t],o.row=n);return o},i.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var r=1/0,o=0,n=this.rows;n>o;o++)this[o][t]<r&&(r=this[o][t]);return r},i.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var r=1/0,o={row:0,column:t},n=0,e=this.rows;e>n;n++)this[n][t]<r&&(r=this[n][t],o.row=n);return o},i.prototype.diag=function f(){if(!this.isSquare())throw new e("Only square matrices have a diagonal.");for(var f=new Array(this.rows),t=0,r=this.rows;r>t;t++)f[t]=this[t][t];return f},i.prototype.sum=function(){for(var t=0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t+=this[n][e];return t},i.prototype.mean=function(){return this.sum()/this.size},i.prototype.prod=function u(){for(var u=1,t=this.rows,r=this.columns,o=0;t>o;o++)for(var n=0;r>n;n++)u*=this[o][n];return u},i.prototype.cumulativeSum=function(){for(var t=0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t+=this[n][e],this[n][e]=t;return this},i.prototype.dot=function h(t){if(this.size!==t.size)throw new e("vectors do not have the same size");for(var r=this.to1DArray(),o=t.to1DArray(),h=0,n=r.length,i=0;n>i;i++)h+=r[i]*o[i];return h},i.prototype.mmul=function(t){this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var r,o,n,e=this.rows,s=this.columns,a=t.columns,f=new i(e,a),u=new Array(s);for(o=0;a>o;o++){for(n=0;s>n;n++)u[n]=t[n][o];for(r=0;e>r;r++){var h=this[r],c=0;for(n=0;s>n;n++)c+=h[n]*u[n];f[r][o]=c}}return f},i.prototype.sortRows=function(t){for(var r=0,o=this.rows;o>r;r++)this[r].sort(t);return this},i.prototype.sortColumns=function(t){for(var r=0,o=this.columns;o>r;r++)this.setColumn(r,this.getColumn(r).sort(t));return this},i.prototype.transpose=function(){for(var t=new i(this.columns,this.rows),r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t[e][n]=this[n][e];return t},i.prototype.subMatrix=function(t,r,o,n){if(t>r||o>n||0>t||t>=this.rows||0>r||r>=this.rows||0>o||o>=this.columns||0>n||n>=this.columns)throw new e("Argument out of range");for(var s=new i(r-t+1,n-o+1),a=t;r>=a;a++)for(var f=o;n>=f;f++)s[a-t][f-o]=this[a][f];return s},i.prototype.subMatrixRow=function(t,r,o){if("undefined"==typeof r?(r=0,o=this.columns-1):"undefined"==typeof o&&(o=this.columns-1),r>o||0>r||r>=this.columns||0>o||o>=this.columns)throw new e("Argument out of range.");for(var n=t.length,s=this.rows,a=new i(n,o-r+1),f=0;n>f;f++)for(var u=r;o>=u;u++){if(t[f]<0||t[f]>=s)throw new e("Argument out of range.");a[f][u-r]=this[t[f]][u]}return a},i.prototype.subMatrixColumn=function(t,r,o){if("undefined"==typeof r?(r=0,o=this.rows-1):"undefined"==typeof o&&(o=this.rows-1),r>o||0>r||r>=this.rows||0>o||o>=this.rows)throw new e("Argument out of range.");for(var n=t.length,s=this.columns,a=new i(o-r+1,n),f=0;n>f;f++)for(var u=r;o>=u;u++){if(t[f]<0||t[f]>=s)throw new e("Argument out of range.");a[u-r][f]=this[u][t[f]]}return a},i.prototype.trace=function c(){if(!this.isSquare())throw new e("The matrix is not square");for(var c=0,t=0,r=this.rows;r>t;t++)c+=this[t][t];return c},i.prototype.abs=function(){for(var t=this.rows,r=this.columns,o=0;t>o;o++)for(var n=0;r>n;n++)this[o][n]=Math.abs(this[o][n])},i.MatrixError=e,r.exports=i},{}],59:[function(t,r,o){"use strict";function n(t,r,o){this.type=t,this.residue=r,this.kind=e.lookup(t,r),this.coordinates=o}var e=t("./kind");r.exports=n},{"./kind":61}],60:[function(t,r,o){"use strict";function n(t){e(t);var r=i(t);s(t,r);for(var o=w(t),n=f(t),a=c(n),u=b(n),h=a[0].normalized.concat(a[1].normalized,a[2].normalized,a[3].normalized),l=0;l<h.length;l++)h[l]=100*h[l]|0;var p=h.concat(a[0].atomCount,a[1].atomCount,a[2].atomCount,a[3].atomCount,o,u);return p}function e(t){var r,o=t.length,n=[0,0,0];for(r=0;o>r;r++)n[0]+=t[r].coordinates[0],n[1]+=t[r].coordinates[1],n[2]+=t[r].coordinates[2];for(n[0]/=o,n[1]/=o,n[2]/=o,r=0;o>r;r++){var e=t[r];e.normCoordinates=[e.coordinates[0]-n[0],e.coordinates[1]-n[1],e.coordinates[2]-n[2]]}}function i(t){var r,o,n,e=t.length,i=M.zeros(3,3);for(r=0;e>r;r++){var s=t[r].normCoordinates;for(o=0;3>o;o++)for(i[o][o]+=s[o]*s[o],n=o+1;3>n;n++){var a=s[o]*s[n];i[o][n]+=a,i[n][o]+=a}}var f=M.zeros(3,3);for(r=0;3>r;r++)for(o=0;3>o;o++)f[r][o]=i[r][o]/(e-1);var u=M.DC.EVD(f),h=u.eigenvectorMatrix,c=u.realEigenvalues;for(r=0;3>r;r++)for(o=r+1;3>o;o++){var l=0;l=h[r][o],h[r][o]=h[o][r],h[o][r]=l}for(r=0;3>r;r++){var p=!0;for(o=0;3>o;o++)if(h[r][o]>=0){p=!1;break}if(p)for(o=0;3>o;o++)h[r][o]*=-1}var m=new Array(3);for(r=0;3>r;r++)m[r]={value:c[r],vector:h[r]};for(m.sort(function(t,r){return r.value-t.value}),r=0;3>r;r++)c[r]=m[r].value,h[r]=m[r].vector;return h}function s(t,r){var o,n,e,i=t.length;for(o=0;i>o;o++){var s=t[o],a=s.normCoordinates,f=new Array(3);for(s.newCoordinates=f,n=0;3>n;n++)for(f[n]=0,e=0;3>e;e++)f[n]+=a[e]*r[n][e]}}function a(t){for(var r={x:[1/0,-(1/0)],y:[1/0,-(1/0)],z:[1/0,-(1/0)]},o=0;o<t.length;o++){var n=t[o].newCoordinates;r.x[0]>n[0]&&(r.x[0]=n[0]),r.x[1]<n[0]&&(r.x[1]=n[0]),r.y[0]>n[1]&&(r.y[0]=n[1]),r.y[1]<n[1]&&(r.y[1]=n[1]),r.z[0]>n[2]&&(r.z[0]=n[2]),r.z[1]<n[2]&&(r.z[1]=n[2])}return r.x[0]-=.5,r.x[1]+=.5,r.y[0]-=.5,r.y[1]+=.5,r.z[0]-=.5,r.z[1]+=.5,r}function f(t){function r(t){return[Math.floor((t[0]-i.x[0])/c[0]),Math.floor((t[1]-i.y[0])/c[1]),Math.floor((t[2]-i.z[0])/c[2])]}var o,n,e,i=a(t),s=13,f=[Math.abs(i.x[0])+Math.abs(i.x[1]),Math.abs(i.y[0])+Math.abs(i.y[1]),Math.abs(i.z[0])+Math.abs(i.z[1])],c=[f[0]/(s-1),f[1]/(s-1),f[2]/(s-1)],l=new Array(s),p=new Array(s),m=new Array(s),d=(s-1)/2,v=t.length,w=[0,0,0];for(o=0;v>o;o++){var g=t[o].newCoordinates;w[0]+=g[0],w[1]+=g[1],w[2]+=g[2]}for(w[0]/=v,w[1]/=v,w[2]/=v,l[d]=w[0],p[d]=w[1],m[d]=w[2],o=d+1;s>o;o++)l[o]=l[o-1]+c[0],p[o]=p[o-1]+c[1],m[o]=m[o-1]+c[2];for(o=d-1;o>=0;o--)l[o]=l[o+1]-c[0],p[o]=p[o+1]-c[1],m[o]=m[o+1]-c[2];var y=s*s*s,b=new Array(y);for(o=0;s>o;o++)for(n=0;s>n;n++)for(e=0;s>e;e++)b[u(o,n,e,s)]=new h(o,n,e);for(o=0;v>o;o++){var M=r(t[o].newCoordinates);t[o].gridPosition=M,b[u(M[0],M[1],M[2],s)].atoms.push(t[o])}return b}function u(t,r,o,n){return t+n*r+n*n*o}function h(t,r,o){this.xGrid=t,this.yGrid=r,this.zGrid=o,this.coordinates=[new Array(3),new Array(3),new Array(3),new Array(3)],this.prop=[0,0,0,0],this.atoms=[]}function c(t){var r,o,n,e,i,s,a=[new v,new v,new v,new v],f=t.length;for(r=0;f>r;r++)if(n=t[r],n.atoms.length){for(e=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]],i=n.atoms.length,o=0;i>o;o++)s=n.atoms[o],e[0][0]+=s.newCoordinates[0],e[0][1]+=s.newCoordinates[1],e[0][2]+=s.newCoordinates[2],n.prop[0]++,a[0].atomCount++,s.kind>0&&(n.prop[s.kind]++,a[s.kind].atomCount++,e[s.kind][0]+=s.newCoordinates[0],e[s.kind][1]+=s.newCoordinates[1],e[s.kind][2]+=s.newCoordinates[2]);for(var u=0;4>u;u++)n.coordinates[u][0]=e[u][0]/n.prop[u],n.coordinates[u][1]=e[u][1]/n.prop[u],n.coordinates[u][2]=e[u][2]/n.prop[u]}for(r=0;f>r;r++)if(n=t[r],0!==n.atoms.length)for(o=r+1;f>o;o++){var h=t[o];if(0!==h.atoms.length)for(var u=0;4>u;u++)if(n.prop[u]>0&&h.prop[u]>0){var c;c=x(n.coordinates[u],h.coordinates[u]),a[u].distances.push(c),a[u].weights.push(n.prop[u]*h.prop[u])}}for(r=0;4>r;r++){var d=a[r];d.frequency=m(d.distances,d.weights),d.normalized=l(p(d.frequency,d.atomCount),r)}return a}function l(t,r){var o=k[r];if(1===o)return t;for(var n=0;n<t.length;n++)t[n]*=o;return t}function p(t,r){for(var o=new Array(t.length),n=0;n<o.length;n++)t[n]>0&&(o[n]=t[n]/Math.pow(r,1.5));return o}function m(t,r){for(var o=0,n=400,e=d(),i=e.length,s=new Array(i),a=0;i>a;s[a++]=0);for(var f=0;f<t.length;f++){var u=t[f];if(!(o>u||u>n))for(var a=0;i>a;a++)s[a]+=r[f]*Math.exp(-((e[a]-u)*(e[a]-u))/(.18*u*.09*u))}return s}function d(){var t=new Array(34),r=1.45;t[0]=r;for(var o=1;34>o;o++)r*=1.18,t[o]=r;return t}function v(){this.atomCount=0,this.distances=[],this.weights=[]}function w(t){var r,o=t.length,n=[0,0,0],e=[0,0,0],i=new Array;1==o&&(e=[1,1,1]);for(var s=0,a=0;3>a;a++)for(var f=a+1;3>f;f++){for(var u=0;o>u;u++){var h=t[u],c=h.newCoordinates,l=y(h.type),p=c[a]*c[a],m=c[f]*c[f],d=p+m;n[s]+=l*d}s++}for(var v=0;v<e.length;){for(var w=1/0,b=-1,a=0;a<n.length;a++){for(var M=!1,f=0;f<i.length;f++)if(i[f]==a){M=!0;break}1!=M&&n[a]<w&&(w=n[a],b=a)}i.push(b),e[v]=w,v++}return r=g(e)}function g(t){var r=[t[0]/t[2],t[1]/t[2]];return r}function y(t){for(var r,o=["C","N","O","S","P"],n=[12,14,16,32,15],e=t.substring(0,1),i=0;i<o.length;i++)if(e==o[i]){r=n[i];break}return r}function b(t){for(var r=0,o=[0,0,0],n=0,e=0;e<t.length;e++){var i=t[e].atoms.length;0!=i&&(o[0]+=t[e].coordinates[0][0]*i,o[1]+=t[e].coordinates[0][1]*i,o[2]+=t[e].coordinates[0][2]*i,n+=i)}for(var e=0;3>e;e++)o[e]=o[e]/n;for(var e=0;e<t.length;e++){var i=t[e].atoms.length;if(0!=i){var s=x(t[e].coordinates[0],o);r+=s*t[e].atoms.length}}return r/=n}var M=t("ml-matrix"),x=t("ml-distance").euclidean;r.exports=n;var k=[1,5,5,2]},{"ml-distance":55,"ml-matrix":57}],61:[function(t,r,o){"use strict";function n(t,r){var o=h[t];if(void 0===o)return e;if("number"==typeof o)return o;var n=o[r];return void 0===n?e:n}var e=(t("fs"),t("path"),0),i=1,s=2,a=3,f={positive:i,negative:s,hydrophobic:a},u={};u.positive="CE LYS\nCZ ARG",u.negative="CG ASP\nCD GLU\nOP1",u.hydrophobic="CB ALA\nCG2 THR\nCB VAL\nCG1 VAL\nCG2 VAL\nCB LEU\nCG LEU\nCD1 LEU\nCD2 LEU\nCB ILE\nCG1 ILE\nCG2 ILE\nCD1 ILE\nCB MET\nCB PRO\nCG PRO\nCB PHE\nCD1 PHE\nCD2 PHE\nCG PHE\nCE1 PHE\nCE2 PHE\nCZ PHE\nCB TYR\nCG TYR\nCD1 TYR\nCD2 TYR\nCE1 TYR\nCE2 TYR\nCB TRP\nCG TRP\nCD2 TRP\nCE3 TRP\nCZ2 TRP\nCZ3 TRP\nCH2 TRP\nCB ASP\nCB GLU\nCG GLU\nCB ASN\nCB GLN\nCG GLN\nCB HIS\nCB LYS\nCG LYS\nCD LYS\nCB ARG\nCG ARG\nC5 U\nC7 U\nC2' U\nC5 T\nC7 T\nC2' T\nC2' A\nC2' C\nC5 C\nC2' G\nC5 DT\nC7 DT\nC2' DT\nC2' DA\nC2' DC\nC5 DC\nC2' DG";var h={};for(var c in f)for(var l=f[c],p=u[c],m=p.split(/[\r\n]+/),d=0;d<m.length;d++){var v=m[d].split(" "),w=v[0];h[w]||(h[w]={}),v[1]?h[w][v[1]]=l:h[w]=l}o.lookup=n},{fs:2,path:3}],62:[function(t,r,o){"use strict";function n(t){for(var r=t.split(/[\r\n]+/),o={atoms:[]},n=["C","N","O","S","P"],i=!0,s=0,a=0,f=0;f<r.length;f++){var u=r[f],h=u.substring(0,6);"HETATM"===h?s++:"ATOM  "===h&&a++}var c=s/(s+a);if(c>.2&&(i=!1),i)for(var l=new Array,f=0;f<r.length;f++){var u=r[f],h=u.substring(0,6);if("HEADER"===h)o.idCode=u.substring(62,66);else if("EXPDTA"===h)o.experiment=u.substring(10);else if("ATOM  "===h){for(var p=u.substring(76,78).trim(),m=!1,d=0;d<n.length;d++)if(p===n[d]){m=!0;break}var v=u.substring(16,17).trim(),w=!1;v.length>0?0==l.length?(w=!0,l.push(v)):v==l[0]&&(w=!0):w=!0,m&&w&&o.atoms.push(new e(u.substring(12,16).trim(),u.substring(17,20).trim(),[parseFloat(u.substring(30,38)),parseFloat(u.substring(38,46)),parseFloat(u.substring(46,54))]))}}else o.experiment="ELSE",o.idCode="null",o.atoms="null";return o}var e=t("./atom");r.exports=n},{"./atom":59}]},{},[1])(1)});
//# sourceMappingURL=pdb-map.min.js.map